//
//  coordinate.cpp
//  Opencv - Test
//
//  Created by Louis Lim on 02/05/2016.
//  Copyright Â© 2016 Louis Lim. All rights reserved.
//


#include <stdio.h>
#include "camera.hpp"
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include <iostream>
#include <dirent.h>
#include <string.h>

using namespace cv;
using namespace std;

void
coordinate ()
{
    String dirName = "/Users/louislim/Documents/image_test";
    DIR *dir;
    int i  = 0;
    Mat image_set [12];
    //Size img_sz [12];
    String imgName;
    struct dirent *ent;
    //int total_width = 0;
    Mat im_all(15000,30000,CV_8UC3);        //cartesian background

    double xcoor [12];
    double ycoor [12];
    double ratio = ((im_all.size()).width)/360;
    for (int i = 0; i<12;i++){
        xcoor[i] = 100.0f * (double)rand() / (double)RAND_MAX - 50.0f;
        std::cout<<xcoor[i]<<std::endl;
        if (xcoor[i] < 0){
            xcoor[i] = (fabs(xcoor[i]))*ratio;
        } else{
            xcoor[i] = (xcoor[i] + 180)*ratio;
        }
        ycoor[i] = 100.0f * (double)rand() / (double)RAND_MAX - 50.0f;
        if (ycoor[i] < 0){
            ycoor[i] = (fabs(ycoor[i]) + 90)*ratio;
        } else{
            ycoor[i] = ycoor[i]*ratio; //correct the picture size here
        }
        
    }
    
        /*
    Mat dst = imread("/Users/louislim/Documents/image_test/mfmrgUM.jpg");
    Mat dst2 = imread("/Users/louislim/Documents/image_test/683844e77898a907b099ecac34b3f989.jpg");
    dst.copyTo(im_all(cv::Rect(0,0,dst.cols, dst.rows)));
    dst2.copyTo(im_all(cv::Rect(120,120,dst2.cols, dst2.rows)));
    //ori => small_image.copyTo(big_image(cv::Rect(x,y,small_image.cols, small_image.rows)));
    */
    
    dir = opendir(dirName.c_str());         //open directory
    if (dir != NULL){
        while ((ent = readdir (dir)) != NULL){
            imgName = ent -> d_name;        //directory name

            if (imgName.find("jpg")!= std::string::npos){       //find image with name jpg behind
                image_set[i] = imread(dirName+"/"+imgName);     //read image with correct path name
                //img_sz[i] = image_set[i].size();                //calculate size
                //double diff_width = (xcoor[i+1] - xcoor[i]);
                //double diff_height = (ycoor[i+1]-ycoor[i]);
                //Mat add_img(im_all, Rect(diff_width,diff_height,img_sz[i].width,img_sz[i].height));
                 
                //Mat add_img(im_all, Rect(total_width,0,img_sz[i].width,img_sz[i].height));
     
                //total_width = total_width + img_sz[i].width;
                image_set[i].copyTo(im_all(cv::Rect(xcoor[i],ycoor[i],image_set[i].cols, image_set[i].rows)));
             
                
                i++;}
        }
      
        closedir(dir);          //close directory
        
    }else {
        std::cout<<"not present"<<std::endl;        //if file not found
    }
    //imwrite("/Users/louislim/Downloads/test_image2.jpg",im_all);
    //imshow("testing", im_all);
    
    waitKey(0);
}
